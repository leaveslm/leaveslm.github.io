<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Linux 安装 MySQL 5.7]]></title>
    <url>%2F2018%2F07%2F18%2FLinux%20%E5%AE%89%E8%A3%85%20%20MySQL%205.7%20%2F</url>
    <content type="text"><![CDATA[MySQL 5.7.22 官方下载地址 清理 MySQL、下载解压清理 find / -name mysql | xargs rm -rf 下载 wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz 解压 tar -zxvf mysql-5.7.22-linux-glibc2.12-x86_64.tar.gz 重命名 mv mysql-5.7.22-linux-glibc2.12-x86_64 mysql 授权 chown -R mysql mysqlchgrp -R mysql mysql 创建 MySQL 组、用户查看有没有mysql组 cat /etc/group | grep mysql 查看有没有mysql用户 cat /etc/passwd |grep mysql 没有则创建 groupadd mysqluseradd -r -g mysql mysql 更改mysql目录下所有的目录及文件夹所属组合用户 chown -R mysql mysqlchgrp -R mysql mysqlcd mysqlls -l123456789drwxr-xr-x. 2 mysql mysql 4096 7月 18 15:04 bin-rw-r--r--. 1 mysql mysql 17987 3月 4 21:40 COPYINGdrwxr-xr-x. 2 mysql mysql 52 7月 18 15:04 docsdrwxr-xr-x. 3 mysql mysql 4096 7月 18 15:04 includedrwxr-xr-x. 5 mysql mysql 4096 7月 18 15:04 libdrwxr-xr-x. 4 mysql mysql 28 7月 18 15:04 man-rw-r--r--. 1 mysql mysql 2478 3月 4 21:40 READMEdrwxr-xr-x. 28 mysql mysql 4096 7月 18 15:04 sharedrwxr-xr-x. 2 mysql mysql 86 7月 18 15:08 support-files 修改 my.cnf 配置文件从 5.7.18 开始不在二进制包中提供 my-default.cnf 文件 vi /etc/my.cnf my-default.cnf12345678910111213141516171819202122232425262728293031# For advice on how to change settings please see# # *** DO NOT EDIT THIS FILE. It‘s a template which will be copied to the# *** default location during install, and will be replaced if you# *** upgrade to a newer version of MySQL.[mysqld]# Remove leading # and set to the amount of RAM for the most important data# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.# innodb_buffer_pool_size = 128M# Remove leading # to turn on a very important data integrity option: logging# changes to the binary log between backups.# log_bin# These are commonly set, remove the # and set as required.# basedir = .....# datadir = .....# port = .....# server_id = .....# socket = .....# Remove leading # to set options mainly useful for reporting servers.# The server defaults are faster for transactions and fast SELECTs.# Adjust sizes as needed, experiment to find the optimal values.# join_buffer_size = 128M# sort_buffer_size = 2M# read_rnd_buffer_size = 2M sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES my.cnf12345678910111213141516171819202122232425262728293031323334353637383940# For advice on how to change settings please see# # *** DO NOT EDIT THIS FILE. It‘s a template which will be copied to the# *** default location during install, and will be replaced if you# *** upgrade to a newer version of MySQL.[client]default-character-set = utf8[mysql]default-character-set = utf8socket = /var/lib/mysql/mysql.sock[mysqld]character-set-server = utf8# Remove leading # and set to the amount of RAM for the most important data# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.# innodb_buffer_pool_size = 128M# Remove leading # to turn on a very important data integrity option: logging# changes to the binary log between backups.# log_bin# These are commonly set, remove the # and set as required.basedir = /usr/local/mysql/datadir = /usr/local/mysql/data/port = 3306#server_id = socket = /var/lib/mysql/mysql.sock# Remove leading # to set options mainly useful for reporting servers.# The server defaults are faster for transactions and fast SELECTs.# Adjust sizes as needed, experiment to find the optimal values.# join_buffer_size = 128M# sort_buffer_size = 2M# read_rnd_buffer_size = 2Mmax_connections = 1000sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES 初始化 MySQL 数据库初始化 cd /usr/local/mysql./bin/mysqld –user=mysql –basedir=/usr/local/mysql –datadir=/usr/local/mysql/data –initialize 输出如下：123456782018-07-18T07:06:49.223422Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).2018-07-18T07:06:49.223579Z 0 [Warning] &apos;NO_ZERO_DATE&apos;, &apos;NO_ZERO_IN_DATE&apos; and &apos;ERROR_FOR_DIVISION_BY_ZERO&apos; sql modes should be used with strict mode. They will be merged with strict mode in a future release.2018-07-18T07:06:49.223591Z 0 [Warning] &apos;NO_AUTO_CREATE_USER&apos; sql mode was not set.2018-07-18T07:06:50.630648Z 0 [Warning] InnoDB: New log files created, LSN=457902018-07-18T07:06:51.000475Z 0 [Warning] InnoDB: Creating foreign key constraint system tables.2018-07-18T07:06:51.028751Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: 24e198b5-8a59-11e8-9a33-aeceb5cf96b1.2018-07-18T07:06:51.031122Z 0 [Warning] Gtid table is not ready to be used. Table &apos;mysql.gtid_executed&apos; cannot be opened.2018-07-18T07:06:51.045661Z 1 [Note] A temporary password is generated for root@localhost: Ra%p1C(&gt;7J(p 添加 RSA Key cd /usr/local/mysqlbin/mysql_ssl_rsa_setup –datadir=/usr/local/mysql/data123456789101112131415Generating a 2048 bit RSA private key..+++.......................................................+++writing new private key to &apos;ca-key.pem&apos;-----Generating a 2048 bit RSA private key....................................................................+++...........................................................+++writing new private key to &apos;server-key.pem&apos;-----Generating a 2048 bit RSA private key..............................................................................................................................................+++..................................+++writing new private key to &apos;client-key.pem&apos;----- 编辑 /usr/local/mysql/support-files/mysql.server 文件 vi /usr/local/mysql/support-files/mysql.server1234...修改 basedir = /usr/local/mysql/修改 datadir = /usr/local/mysql/data/... 启动 MySQL 服务 cd /usr/local/mysql./support-files/mysql.server start 注意：如果遇到以下问题，执行以下操作Starting MySQL.Logging to ‘/usr/local/mysql/data/localhost.localdomain.err’.2018-07-18T07:08:26.909710Z mysqld_safe Directory ‘/var/lib/mysql’ for UNIX socket file don’t exists. mkdir /var/lib/mysqlchown mysql:mysql /var/lib/mysqlcd /usr/local/mysql./support-files/mysql.server start Starting MySQL… SUCCESS! ./support-files/mysql.server stop Shutting down MySQL… SUCCESS! ./support-files/mysql.server restart Shutting down MySQL… SUCCESS!Starting MySQL… SUCCESS! 修改 Root 密码，开启远程访问 cd /usr/local/mysql./bin/mysqld_safe –skip-grant-tables –skip-networking&amp; 登陆 cd /usr/local/mysql/bin./mysql -uroot -p 修改密码、授权远程登陆 mysql&gt;set password=password(“123456”);use mysql;update user set host=’%’ where user=’root’;GRANT ALL PRIVILEGES ON . TO ‘myuser‘@’%’ IDENTIFIED BY ‘mypwd’ WITH GRANT OPTION;FLUSH PRIVILEGES;exit; 重启 MySQL 服务 service mysql restart; 查看编码 show variables like ‘character%’; 配置 MySQL 服务开机自动启动拷贝启动文件到 /etc/init.d/ 下并重命令为 mysqld cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld 增加执行权限 chmod 755 /etc/init.d/mysqld 检查自启动项列表中没有 mysqld 这个，如果没有就添加 mysqld chkconfig –list mysqldchkconfig –add mysqld 设置MySQL在345等级自动启动 chkconfig –level 345 mysqld on 或用这个命令设置开机启动: chkconfig mysqld on MySQL 服务的启动/重启/停止启动 MySQL 服务 service mysqld start 停止 MySQL 服务 service mysqld stop 重启 MySQL 服务 service mysqld restart]]></content>
      <categories>
        <category>基础服务</category>
      </categories>
      <tags>
        <tag>mysql</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Windows 安装 MySQL 5.7]]></title>
    <url>%2F2018%2F04%2F24%2FWindows%20%E5%AE%89%E8%A3%85%20MySQL%205.7%2F</url>
    <content type="text"><![CDATA[MySQL 5.7.xx ZIP版本配置方案MySQL 5.7.22 官方下载地址MySQL 官方配置参数查询 一、下载 MySQL 5.7.xx zip 安装包本机以 Windows10 64 位系统为例进入 Oracel 官网，选择 MySQL Windows (x86, 64-bit), ZIP Archive 下载包点此下载 二、解压安装包将MySQL数据库解压至目录 D:\Program Files\MySQL\mysql-5.7.xx-winx64将 D:\Program Files\MySQL\mysql-5.7.xx-winx64\bin 添加至环境变量 Path 中 三、创建一个空文件夹，命名为“data”，用来存放数据本机创建在 D:\Program Files\MySQL\mysql-5.7.xx-winx64 目录下，所以最后会看到D:\Program Files\MySQL\mysql-5.7.xx-winx64\data，此文件夹后面会有用到 四、配置启动配置文件把 D:\Program Files\MySQL\mysql-5.7.xx-winx64\my-default.ini 文件复制一份，重新命名为 my.ini，修改里面的几个参数， 配置文件如下： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# For advice on how to change settings please see# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html# *** DO NOT EDIT THIS FILE. It&apos;s a template which will be copied to the# *** default location during install, and will be replaced if you# *** upgrade to a newer version of MySQL.[client]default-character-set=utf8[mysql]default-character-set=utf8[mysqld]character-set-server=utf8# Remove leading # and set to the amount of RAM for the most important data# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.# innodb_buffer_pool_size = 128M# Remove leading # to turn on a very important data integrity option: logging# changes to the binary log between backups.# log_bin# These are commonly set, remove the # and set as required.# server_id = .....# MySQL 安装目录basedir = D:\Program Files\MySQL\mysql-5.7.22-winx64# MySQL 数据库数据存放目录datadir = D:\Program Files\MySQL\mysql-5.7.22-winx64\data# MySQL 端口port = 3306# 允许最大连接数，默认200max_connections=200# Remove leading # to set options mainly useful for reporting servers.# The server defaults are faster for transactions and fast SELECTs.# Adjust sizes as needed, experiment to find the optimal values.# join_buffer_size = 128M# sort_buffer_size = 2M# read_rnd_buffer_size = 2Msql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES# 创建新表时将使用的默认存储引擎default-storage-engine=INNODB# explicit_defaults_for_timestamp=true 五、初始化数据目录 管理员身份打开 CMD; 当前路径定位到 D:\Program Files\MySQL\mysql-5.7.xx-winx64\bin 按照mysql官方文档给出的步骤还有一步 Selecting a MySQL Server Type，就是选择用 mysqld 还是 mysqld-debug. 一般使用如下命令： mysqld –defaults-file=”D:\Program Files\MySQL\mysql-5.7.xx-winx64\my.ini” –initialize-insecure 注： 这个命令很重要，它会初始化 data 目录，在执行此命令前请先把 data 目录下的所有文件先删除，否则会失败； 可以选择用 –initialize-insecure 或者 –initialize 来初始化，–initialize-insecure 初始化 root 密码为空，如果用 –initialize 来初始化，会产生一个随机密码； 执行成功后你会在 data 目录 下看到 mysql，perofrmance_schema，sys 目录，同时还会有一些文件。 六、安装 mysql 服务 mysqld -installmysqld -remove （出问题重新配置前需要卸载服务） 七、启动 mysql 服务、添加初始密码 net start mysqlmysqladmin -u root password 123456mysql -u root -p 八、设置默认编码先确保my.ini添加以下代码12345678[client]default-character-set=utf8[mysql]default-character-set=utf8[mysqld]default-character-set=utf8 或者 character-set-server=utf8 通过命令查看数据库当前编码 mysql -u root -pshow variables like ‘character%’; 如果不是以下编码，则设置编码12345678910111213+--------------------------+------------------------------------------------------------+| Variable_name | Value |+--------------------------+------------------------------------------------------------+| character_set_client | utf8 || character_set_connection | utf8 || character_set_database | utf8 || character_set_filesystem | binary || character_set_results | utf8 || character_set_server | utf8 || character_set_system | utf8 || character_sets_dir | D:\Program Files\MySQL\mysql-5.7.22-winx64\share\charsets\ |+--------------------------+------------------------------------------------------------+8 rows in set, 1 warning (0.00 sec) 设置编码： SET character_set_client = utf8;SET character_set_connection = utf8;SET character_set_database = utf8;SET character_set_results = utf8;SET character_set_server = utf8; character_set_client为客户端编码方式； character_set_connection为建立连接使用的编码； character_set_database数据库的编码； character_set_results结果集的编码； character_set_server数据库服务器的编码； 九、mysql 开启远程连接 grant all privileges on *.* to ‘root‘@’%’ identified by ‘123456’ with grant option; 后记：如果中途有什么步骤失败，一定要执行 mysql 移除命令，然后删除 data 目录下的所有文件，然后删除服务 mysqld -remove特别提醒：5.7 和 5.6 不太相同，要自己初始化数据 data 目录，不然启动不会成功 十、后记mysql 安装完后可能会用到的语句123456789101112131415161718192021222324alter user &apos;root&apos;@&apos;localhost&apos; identified by &apos;123&apos;;create database victor;create user &apos;victor&apos;@&apos;localhost&apos; identified by &apos;victor@123&apos;;flush privileges;creaet user &apos;victorremote&apos;@&apos;%&apos; identified by &apos;victorremote@123&apos;;flush privileges;grant all on victor.* to &apos;victor&apos;@&apos;localhost&apos; identified by &apos;victor@123&apos;;flush privileges;grant all on victor.* to &apos;victorremote&apos;@&apos;%&apos; identified by &apos;victorremote@123&apos;;flush privileges;#################################连接最大空闲时长SHOW GLOBAL VARIABLES LIKE &apos;wait_timeout&apos;;#最大连接数SHOW VARIABLES LIKE &apos;%max_connections%&apos;;SET GLOBAL max_connections = 200;#字符编码SHOW VARIABLES WHERE Variable_name LIKE &apos;character\_set\_%&apos; OR Variable_name LIKE &apos;collation%&apos;;SHOW GLOBAL STATUS LIKE &apos;innodb_buffer_pool_pages_%&apos;;SHOW PROCESSLIST;SHOW STATUS LIKE &apos;Table%&apos;;SHOW STATUS LIKE &apos;%lock%&apos;;################################]]></content>
      <categories>
        <category>基础服务</category>
      </categories>
      <tags>
        <tag>mysql</tag>
        <tag>windows</tag>
      </tags>
  </entry>
</search>
